<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>股東會通知及過戶停止日期計算器</title>
</head>
<body>
    <h1>股東會通知及過戶停止日期計算器</h1>
    
    <label for="companyType">選擇公司類型:</label>
    <select id="companyType">
        <option value="nonPublic">非公開發行公司</option>
        <option value="public">公開發行股票公司</option>
    </select>
    <br><br>
    
    <label for="meetingType">選擇會議類型:</label>
    <select id="meetingType">
        <option value="regular">股東常會</option>
        <option value="special">股東臨時會</option>
    </select>
    <br><br>
    
    <label for="meetingDate">預計股東會召開日期:</label>
    <input type="date" id="meetingDate">
    <button onclick="calculateDates()">計算日期</button>
    
    <p id="resultNotification"></p>
    <p id="resultStopTransfer"></p>

    <script>
        function calculateDates() {
            const companyType = document.getElementById('companyType').value;
            const meetingType = document.getElementById('meetingType').value;
            const meetingDateInput = document.getElementById('meetingDate').value;
            
            if (!meetingDateInput) {
                document.getElementById('resultNotification').textContent = '請輸入股東會召開日期。';
                document.getElementById('resultStopTransfer').textContent = '';
                return;
            }
            
            const meetingDate = new Date(meetingDateInput);

            // 計算最晚通知日期
            let notificationDate = new Date(meetingDate);
            if (companyType === 'nonPublic') {
                if (meetingType === 'regular') {
                    notificationDate.setDate(notificationDate.getDate() - 20);  // 非公開發行公司股東常會：往前推20天
                } else if (meetingType === 'special') {
                    notificationDate.setDate(notificationDate.getDate() - 10);  // 非公開發行公司股東臨時會：往前推10天
                }
            } else if (companyType === 'public') {
                if (meetingType === 'regular') {
                    notificationDate.setDate(notificationDate.getDate() - 30);  // 公開發行公司股東常會：往前推30天
                } else if (meetingType === 'special') {
                    notificationDate.setDate(notificationDate.getDate() - 15);  // 公開發行公司股東臨時會：往前推15天
                }
            }
            notificationDate.setDate(notificationDate.getDate() - 1);  // 不算入起算日

            const notificationYear = notificationDate.getFullYear();
            const notificationMonth = (notificationDate.getMonth() + 1).toString().padStart(2, '0');
            const notificationDay = notificationDate.getDate().toString().padStart(2, '0');
            document.getElementById('resultNotification').textContent = `最晚需在 ${notificationYear}-${notificationMonth}-${notificationDay} 通知股東。`;

            // 計算停止過戶期間的起始日期
            let stopTransferDate = new Date(meetingDate);
            if (companyType === 'nonPublic') {
                if (meetingType === 'regular') {
                    stopTransferDate.setDate(stopTransferDate.getDate() - 29);  // 非公開發行公司股東常會：往前推29天，包含開會日
                } else if (meetingType === 'special') {
                    stopTransferDate.setDate(stopTransferDate.getDate() - 14);  // 非公開發行公司股東臨時會：往前推14天，包含開會日
                }
            } else if (companyType === 'public') {
                if (meetingType === 'regular') {
                    stopTransferDate.setDate(stopTransferDate.getDate() - 59);  // 公開發行公司股東常會：往前推59天，包含開會日
                } else if (meetingType === 'special') {
                    stopTransferDate.setDate(stopTransferDate.getDate() - 29);  // 公開發行公司股東臨時會：往前推29天，包含開會日
                }
            }

            const stopTransferYear = stopTransferDate.getFullYear();
            const stopTransferMonth = (stopTransferDate.getMonth() + 1).toString().padStart(2, '0');
            const stopTransferDay = stopTransferDate.getDate().toString().padStart(2, '0');
            document.getElementById('resultStopTransfer').textContent = `停止股票過戶期間自 ${stopTransferYear}-${stopTransferMonth}-${stopTransferDay} 起至 ${meetingDateInput} 止。`;
        }
    </script>
</body>
</html>
